<!DOCTYPE html>
<!-- saved from url=(0044)http://oos.moxiecode.com/js_webgl/tree_rays/ -->
<html lang="en" class="hb-loaded"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Trees + Rays</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" type="text/css" href="./Trees + Rays_files/style_no_stats.css">
		<style type="text/css">
			body {
				background:#000000;
			}
		</style>
	<style type="text/css" adt="123"></style><script>if(!document.URL.match(/^http:\/\/v\.baidu\.com|http:\/\/music\.baidu\.com|http:\/\/dnf\.duowan\.com|http:\/\/bbs\.duowan\.com|http:\/\/newgame\.duowan\.com|http:\/\/my\.tv\.sohu\.com/)){
(function() {
    Function.prototype.bind = function() {
        var fn = this, args = Array.prototype.slice.call(arguments), obj = args.shift();
        return function() {
            return fn.apply(obj, args.concat(Array.prototype.slice.call(arguments)));
        };
    };
    function A() {}
    A.prototype = {
        rules: {
            /*'youku_loader': {
                'find': /^http:\/\/static\.youku\.com\/.*(loader|player_.*)(_taobao)?\.swf/,
                'replace': 'http://swf.adtchrome.com/loader.swf'
            },
            'youku_out': {
                'find': /^http:\/\/player\.youku\.com\/player\.php\/.*sid\/(.*)/,
                'replace': 'http://swf.adtchrome.com/loader.swf?VideoIDS=$1'
            },*/
            'pps_pps': {
                'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/pps_flvplay_s\.swf/,
                'replace': 'http://swf.adtchrome.com/pps_20140420.swf'
            },
            /*'iqiyi_1': {
                'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/.+\.swf$/,
                'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
            },
            'iqiyi_2': {
                'find': /^http:\/\/www\.iqiyi\.com\/common\/flashplayer\/\d+\/.+\.swf$/,
                'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
            },*/
            'ku6': {
                'find': /^http:\/\/player\.ku6cdn\.com\/default\/.*\/\d+\/(v|player|loader)\.swf/,
                'replace': 'http://swf.adtchrome.com/ku6_20140420.swf'
            },
            'ku6_topic': {
                'find': /^http:\/\/player\.ku6\.com\/inside\/(.*)\/v\.swf/,
                'replace': 'http://swf.adtchrome.com/ku6_20140420.swf?vid=$1'
            },
            'sohu': {
                'find': /^http:\/\/tv\.sohu\.com\/upload\/swf(\/p2p)?\/\d+\/Main\.swf/,
                'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf'
            },
            'sohu2':{
                'find':/^http:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\/testplayer\/Main0?\.swf/,
                'replace':'http://www.adtchrome.com/sohu/sohu_20150104.swf'
            },
            'sohu_share': {
                'find': /^http:\/\/share\.vrs\.sohu\.com\/my\/v\.swf&/,
                'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?'
            },
            'sohu_sogou' : {
                'find': /^http:\/\/share\.vrs\.sohu\.com\/(\d+)\/v\.swf/,
                'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?vid=$1'
            },
            /*'letv': {
                'find': /^http:\/\/player\.letvcdn\.com\/.*p\/.*\/newplayer\/LetvPlayer\.swf/,
                'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
            },
            'letv_topic': {
                'find': /^http:\/\/player\.hz\.letv\.com\/hzplayer\.swf\/v_list=zhuanti/,
                'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
            },
            'letv_duowan': {
                'find': /^http:\/\/assets\.dwstatic\.com\/video\/vpp\.swf/,
                'replace': 'http://yuntv.letv.com/bcloud.swf'
            },*/
            '17173_in':{
                'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
            },
            '17173_out':{
                'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
            },
            '17173_live':{
                'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
            },
            '17173_live_out':{
                'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
            }
        },
        _done: null,
        get done() {
            if(!this._done) {
                this._done = new Array();
            }
            return this._done;
        },
        addAnimations: function() {
            var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
            document.getElementsByTagName('head')[0].appendChild(style);
        },
        animationsHandler: function(e) {
            if(e.animationName === 'playerInserted') {
                this.replace(e.target);
            }
        },
        replace: function(elem) {
            if(this.done.indexOf(elem) != -1) return;
            this.done.push(elem);
            var player = elem.data || elem.src;
            if(!player) return;
            var i, find, replace = false;
            for(i in this.rules) {
                find = this.rules[i]['find'];
                if(find.test(player)) {
                    replace = this.rules[i]['replace'];
                    if('function' === typeof this.rules[i]['preHandle']) {
                        this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                    }else{
                        this.reallyReplace.bind(this, elem, find, replace)();
                    }
                    break;
                }
            }
        },
        reallyReplace: function(elem, find, replace) {
            elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
            var b = elem.querySelector("param[name='movie']");
            this.reloadPlugin(elem);
        },
        reloadPlugin: function(elem) {
            var nextSibling = elem.nextSibling;
            var parentNode = elem.parentNode;
            parentNode.removeChild(elem);
            var newElem = elem.cloneNode(true);
            this.done.push(newElem);
            if(nextSibling) {
                parentNode.insertBefore(newElem, nextSibling);
            } else {
                parentNode.appendChild(newElem);
            }
        },
        init: function() {
            var desc = navigator.mimeTypes['application/x-shockwave-flash'].description.toLowerCase();
            /*if(desc.indexOf('adobe')>-1){
                delete this.rules["iqiyi_1"];
                delete this.rules["iqiyi_2"];
            }*/
            if(document.URL.indexOf('tv.sohu.com')<=0){
                delete this.rules["sohu"];
            }
            var handler = this.animationsHandler.bind(this);
            document.body.addEventListener('webkitAnimationStart', handler, false);
            document.body.addEventListener('msAnimationStart', handler, false);
            document.body.addEventListener('oAnimationStart', handler, false);
            document.body.addEventListener('animationstart', handler, false);
            this.addAnimations();
        }
    };
    new A().init();
})();
}
// 20140730
(function cnbeta() {
    if (document.URL.indexOf('cnbeta.com') >= 0) {
        var elms = document.body.querySelectorAll("p>embed");
        Array.prototype.forEach.call(elms, function(elm) {
            elm.style.marginLeft = "0px";
        });
    }
})();
// 20150108
setTimeout(function(){
    if (document.URL.indexOf('www.baidu.com') >= 0) {
        var a = function(){
            Array.prototype.forEach.call(document.body.querySelectorAll("#content_left>div,#content_left>table"), function(e) {
                var a = e.getAttribute("style");
                if(a && /display:(table|block)\s!important/.test(a)){
                    e.removeAttribute("style")
                }
            });
        };
        a();
        document.getElementById("su").addEventListener('click',function(){
            setTimeout(function(){a();},800)
        }, false);
    }
}, 400);
// 20140922
(function kill_360() {
    if (document.URL.indexOf('so.com') >= 0) {
        document.getElementById("e_idea_pp").style.display = none;
    }
})();
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style></head>

	<body huaban_collector_injected="true" youdao="bind">

		<div id="infobutton">
			<a href="javascript:toggleInfo()"><img src="./Trees + Rays_files/i.png" border="0"></a>
		</div>
		<div id="info">
				<b>Trees + Rays - WebGL(html5)</b><br>
				Move mouse to move the camera around.
				<p>Trying to do some sun rays/god rays/volumetric light shafts.<br>
				Following <a href="http://fabiensanglard.net/lightScattering/" target="_blank">this approach</a>.</p>
				Done using <a href="https://github.com/mrdoob/three.js" target="_blank">three.js</a>.
				<p><b>Note.</b> You need a modern browser that supports WebGL for this to run the way it is intended.<br>
				For example. <a href="http://www.google.com/landing/chrome/beta/" target="_blank">Google Chrome 9+</a> or <a href="http://www.mozilla.com/firefox/beta/" target="_blank">Firefox 4+</a>.<br><br>(If you are already using one of those browsers and it's still not running, it's possible that you<br>have old blacklisted GPU drivers. Try updating the drivers for your graphic card.<br>Or try to set a '--ignore-gpu-blacklist' switch for the browser.)</p>
				<font color="#777777">(C) OutsideOfSociety 2013.
		</font></div><font color="#777777">

		<script src="./Trees + Rays_files/three.min.js"></script>

		<script src="./Trees + Rays_files/CopyShader.js"></script>
		<script src="./Trees + Rays_files/ConvolutionShader.js"></script>
		<script src="./Trees + Rays_files/FilmShader.js"></script>
		<script src="./Trees + Rays_files/FXAAShader.js"></script>
		<script src="./Trees + Rays_files/RadialBlurShader.js"></script>

		<script src="./Trees + Rays_files/EffectComposer.js"></script>
		<script src="./Trees + Rays_files/MaskPass.js"></script>
		<script src="./Trees + Rays_files/RenderPass.js"></script>
		<script src="./Trees + Rays_files/ShaderPass.js"></script>
		<script src="./Trees + Rays_files/BloomPass.js"></script>

		<script src="./Trees + Rays_files/CustomDepthShader.js"></script>

		<script type="text/javascript" src="./Trees + Rays_files/THREEx.WindowResize.js"></script>
		<script type="text/javascript" src="./Trees + Rays_files/info.js"></script>

		<script>

			var container;

			var camera, cameraDepth, scene, sceneDepth, renderer, composer;

			var has_gl = false;

			var delta;
			var time;
			var oldTime;

			var array = [];

			var effectRadialBlur;
			var effectBloom;
			var fxaa;
			var materialDepth;
			var depthTarget;
			var depthScale = 0.5;
			var light;

			var projector = new THREE.Projector();
			var cameraTarget = new THREE.Vector3();
			var pointLight;

			var texture;
			var overlay;

			var butterflys = [];
			var butterflysDepth = [];

			var loader;

			var mouseXpercent = 0;
			var mouseYpercent = 0;

			var treeArray = [];

			document.addEventListener( 'mousemove', onDocumentMouseMove, false );

			document.addEventListener( 'touchmove', onTouchMove, false );


			init();
			//animate();

			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				scene = new THREE.Scene();
				sceneDepth = new THREE.Scene();
				
				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 10, 80000 );
				camera.position.z = 200;
				scene.add( camera );

				cameraDepth = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 10, 2000 );
				cameraDepth.position.z = 200;
				sceneDepth.add( cameraDepth );


				texture = THREE.ImageUtils.loadTexture( "Leaves_02.png" );

				// tree
				loader = new THREE.JSONLoader();
				loader.load( "Tree_04.js", treeLoaded );
				loader.load( "Tree_04.js", tree2Loaded );
				loader.load( "butterfly.js", butterflyLoaded );


				light = new THREE.Object3D();

				var s = 250;
				light.position.set(0, 600, -1600);

				scene.add(light);

				var textureFlare0 = THREE.ImageUtils.loadTexture( "lensflare0.png" );

			    var flareMaterial = new THREE.SpriteMaterial( { map: textureFlare0, useScreenCoordinates: false, color: 0xf8ce9c, fog: false, blending: THREE.AdditiveBlending } );
			    sun = new THREE.Sprite( flareMaterial );
			    sun.scale.set( 2000, 2000, 1 );
			    light.add(sun);

				var m = new THREE.MeshBasicMaterial( { color: 0xFAD6A5 } );
				var light2 = new THREE.Mesh( new THREE.SphereGeometry(1,20,20), m );

				light2.scale.set(s,s,s/10);
				light2.position.set(0, 600, -1600);

				sceneDepth.add(light2);


				pointLight = new THREE.PointLight( 0xFAD6A5, 1.5 );
				pointLight.position.set(0,0,-1400)
				scene.add(pointLight);

				var dirLight = new THREE.DirectionalLight( 0xFAD6A5, 0.1 );
				dirLight.position.set(0,0.5,1)
				scene.add(dirLight);


				var aspect = window.innerWidth / window.innerHeight;

			    var overlayMaterial = new THREE.SpriteMaterial( { map: THREE.ImageUtils.loadTexture( "gradient.jpg" ), useScreenCoordinates: false } );
			    overlay = new THREE.Sprite( overlayMaterial );
			    overlay.scale.set( (window.innerWidth*aspect)*150, (window.innerHeight*aspect)*60, 1 );
			    overlay.position.set(0, 15000, -40000);
			    camera.add(overlay);

			    var cloudTextures = [ THREE.ImageUtils.loadTexture( "cloud0.png" ),
			    					  THREE.ImageUtils.loadTexture( "cloud1.png" ) ];
			    var sizes = [ {w:596,h:297}, {w:749,h:328} ];

			    for (var i = 0; i < 12; i++) {
			    	var scale = 20 + Math.random()*20;
			    	var opacity = 0.05 + Math.random()*0.15;
			    	var index = i%2;

			    	var map = cloudTextures[index];
			    	var size = sizes[index];

			    	var xs = 1;
			    	if (Math.random() < 0.5) xs = -1;

				    var cloudMaterial = new THREE.SpriteMaterial( { map: map, useScreenCoordinates: false, opacity: opacity } );
				    var cloud = new THREE.Sprite( cloudMaterial );
				    cloud.scale.set( size.w*scale*xs, size.h*scale, 1 );
				    cloud.position.set(Math.random()*60000 - 30000, -3000 + Math.random()*-2000, -20000);
				    scene.add(cloud);

				    if (i>10) {
				    	var scale = 30 + Math.random()*30;
				    	cloud.scale.set( size.w*scale*xs, size.h*scale, 1 );
				    	cloud.position.y = 25000 + Math.random()*2000;
				    	var opacity = 0.25 + Math.random()*0.15;
				    	cloud.material.opacity = opacity;
				    }

			    }



				try {
					// renderer
					renderer = new THREE.WebGLRenderer({antialias: false});
					renderer.setSize( window.innerWidth, window.innerHeight );
					renderer.setClearColor( 0x000000, 0 );
					THREEx.WindowResize(renderer, camera);

					var parameters = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBFormat };
					depthTarget = new THREE.WebGLRenderTarget( window.innerWidth*depthScale, window.innerHeight*depthScale, parameters );

					// postprocessing
					renderer.autoClear = false;
					var renderModel = new THREE.RenderPass( scene, camera, null, 0x425464 );
					effectRadialBlur = new THREE.ShaderPass( THREE.RadialBlurShader );
					effectRadialBlur.uniforms[ "tDepth" ].value = depthTarget;
					effectBloom = new THREE.BloomPass( 1.1 );
					
					fxaa = new THREE.ShaderPass( THREE.FXAAShader );
					fxaa.uniforms[ 'resolution' ].value = new THREE.Vector2( 1/window.innerWidth, 1/window.innerHeight );

					var effectCopy = new THREE.ShaderPass( THREE.CopyShader );
					effectCopy.renderToScreen = true;

					composer = new THREE.EffectComposer( renderer );

					composer.addPass( renderModel );
					composer.addPass( effectRadialBlur );
					composer.addPass( effectBloom );
					composer.addPass( fxaa );
					composer.addPass( effectCopy );


					container.appendChild( renderer.domElement );
					has_gl = true;

					window.addEventListener( 'resize', onWindowResize, false );

					container.style.cursor = "url(cursor.png),pointer";
				}
				catch (e) {
					// need webgl
					document.getElementById('info').innerHTML = "<P><BR><B>Note.</B> You need a modern browser that supports WebGL for this to run the way it is intended.<BR>For example. <a href='http://www.google.com/landing/chrome/beta/' target='_blank'>Google Chrome 9+</a> or <a href='http://www.mozilla.com/firefox/beta/' target='_blank'>Firefox 4+</a>.<BR><BR>If you are already using one of those browsers and still see this message, it's possible that you<BR>have old blacklisted GPU drivers. Try updating the drivers for your graphic card.<BR>Or try to set a '--ignore-gpu-blacklist' switch for the browser.</P><CENTER><BR><img src='../general/WebGL_logo.png' border='0'></CENTER>";
					document.getElementById('info').style.display = "block";
					return;
				}

			}

			function butterflyLoaded( geometry ) {

				geometry.computeMorphNormals();

				var colors = [0xd4c564, 0xaaaaaa, 0xdc6e32, 0x4d3e35];

				for (var i = 0; i < 7; i++) {

					var material = new THREE.MeshPhongMaterial( { color: colors[i%colors.length], specular: 0x999999, shininess: 60, morphTargets: true, morphNormals: true, side: THREE.DoubleSide, shading: THREE.SmoothShading } );
				
					var mesh = new THREE.MorphAnimMesh( geometry, material );
					mesh.duration = 1500;
					mesh.time = Math.random()*mesh.duration;

					mesh.position.set(Math.random()*200 - 100, -100-Math.random()*100, 120 + Math.random()*70);

					scene.add( mesh );

					var target = new THREE.Vector3(Math.random()*300 - 150, 150 + Math.random()*100 , 100 + Math.random()*70);
					var look = new THREE.Vector3();

					var distance = mesh.position.distanceTo(target);
					var speed = distance*0.000000001;

					butterflys.push({mesh: mesh, target: target, time: 0, distance: distance, speed: speed, look: look});

				}

				loader.load( "butterfly.js", butterflyDepthLoaded );

			}

			function butterflyDepthLoaded( geometry ) {

				for (var i = 0; i < butterflys.length; i++) {
					var materialDepth = new THREE.MeshBasicMaterial( { color: 0x000000, morphTargets: true, side: THREE.DoubleSide } );
	
					var meshDepth = new THREE.MorphAnimMesh( geometry, materialDepth );
					meshDepth.duration = butterflys[i].mesh.duration;
					meshDepth.time = butterflys[i].mesh.time;

					sceneDepth.add(meshDepth);

					butterflysDepth.push(meshDepth);
				}

			}

			function runButterflys () {

				if (butterflys.length <= 0 || butterflysDepth.length <= 0) return;
			
				for (var i = 0; i < butterflys.length; i++) {
					var o = butterflys[i];
					o.mesh.updateAnimation( delta );

					o.time += delta * o.speed;

					o.look.copy(o.mesh.position);

					o.mesh.position.lerp(o.target, o.time);

					o.mesh.position.x += Math.sin((time/2000) + i)*1;
					o.mesh.position.z -= Math.cos((time/1500) + i)*0.5;

					o.mesh.lookAt(o.look);

					// respawn?

					if (o.mesh.position.y >= 150) {

						o.time = 0;
						o.mesh.position.set(Math.random()*200 - 100, -100-Math.random()*100, 120 + Math.random()*70);
						o.target = new THREE.Vector3(Math.random()*300 - 150, 150 + Math.random()*100 , 100 + Math.random()*70);
						o.distance = o.mesh.position.distanceTo(o.target);
						o.speed = o.distance*0.000000001;

					}


					var od = butterflysDepth[i];
					od.updateAnimation( delta );
					od.position = o.mesh.position;
					od.rotation = o.mesh.rotation;

					
				}

			}
		

			function treeLoaded( geometry, mm ) {

				geometry.computeFaceNormals();
				geometry.computeVertexNormals();

				var material0 = new THREE.MeshPhongMaterial( { color: 0xb5c99e, map: texture, transparent: true, alphaTest: 0.9, specular: 0xffffff, ambient: 0x999999 } )
				mm[0] = material0;

				var mf = new THREE.MeshFaceMaterial( mm );

				// tree
				var tree = new THREE.Mesh( geometry, mf );
				tree.scale.set(7,7,7);
				tree.position.y = -200;
				scene.add(tree);

				var tree2 = new THREE.Mesh( geometry, mf );
				tree2.scale.set(7,7,7);
				tree2.rotation.y = 1;
				tree2.position.set(200,-250,-150);
				scene.add(tree2);


				var tree3 = new THREE.Mesh( geometry, mf );
				tree3.scale.set(8,8,8);
				tree3.rotation.y = -1;
				tree3.position.set(-230,-300,-130);
				scene.add(tree3);

				var tree4 = new THREE.Mesh( geometry, mf );
				tree4.scale.set(9,9,9);
				tree4.rotation.y = -2;
				tree4.position.set(40,-400,-240);
				scene.add(tree4);

				treeArray.push(tree);
				treeArray.push(tree2);
				treeArray.push(tree3);
				treeArray.push(tree4);

				animate();

			}

			function tree2Loaded( geometry, mm ) {

				var material0 = new THREE.MeshBasicMaterial( { color: 0x000000, map: texture, transparent: true, alphaTest: 0.5 } )
				var material1 = new THREE.MeshBasicMaterial( {color: 0x000000} )

				mm[0] = material0;
				mm[1] = material1;

				var mf = new THREE.MeshFaceMaterial( mm );

				// tree
				var tree = new THREE.Mesh( geometry, mf );
				tree.scale.set(7,7,7);
				tree.position.y = -200;
				sceneDepth.add(tree);

				treeArray.push(tree);

			}

			function onWindowResize( event ) {
				composer.setSize( window.innerWidth, window.innerHeight );

				var aspect = window.innerWidth / window.innerHeight;
				overlay.scale.set( (window.innerWidth*aspect)*150, (window.innerHeight*aspect)*60, 1 );

				fxaa.uniforms[ 'resolution' ].value = new THREE.Vector2( 1/window.innerWidth, 1/window.innerHeight );

			}

			function onDocumentMouseMove(event) {

				event.preventDefault();

				var mouseX = ( event.clientX - window.innerWidth / 2 );
				var mouseY = ( event.clientY - window.innerHeight / 2 );

				mouseXpercent = mouseX/(window.innerWidth/2);
				mouseYpercent = mouseY/(window.innerHeight/2);

			}			

			function onTouchMove(event) { 
				event.preventDefault();

				var mouseX = ( event.touches[0].clientX - window.innerWidth / 2 );
				var mouseY = ( event.touches[0].clientY - window.innerHeight / 2 );

				mouseXpercent = mouseX/(window.innerWidth/2);
				mouseYpercent = mouseY/(window.innerHeight/2);

			}

			function animate() {

				requestAnimationFrame( animate );

				render();

			}

			function getScreenPosition (object) {
				var vector = projector.projectVector(new THREE.Vector3().getPositionFromMatrix(object.matrixWorld), camera);
				return vector;
			}

			function render() {

				time = Date.now();
				delta = time - oldTime;
				oldTime = time;

				if (isNaN(delta) || delta > 1000 || delta == 0 ) {
					delta = 1000/60;
				}

				var optimalDivider = delta/16;

				for (var i = 0; i < treeArray.length; i++) {
					treeArray[i].rotation.z = Math.sin(time/600)*0.015;
					treeArray[i].rotation.x = Math.cos(time/600)*0.01;
				}

				runButterflys();

				camera.position.x += (mouseXpercent * 80 - camera.position.x)/Math.max(2, (20/optimalDivider) );
				camera.position.y += ((-mouseYpercent * 60 - 80) - camera.position.y)/Math.max(2, (20/optimalDivider) );
				camera.lookAt(cameraTarget);
				camera.up.x += (mouseXpercent*-0.15 - camera.up.x)/Math.max(2, (20/optimalDivider) );

				cameraDepth.position.x = camera.position.x;
				cameraDepth.position.y = camera.position.y;
				cameraDepth.lookAt(cameraTarget);
				cameraDepth.up.x = camera.up.x;

				var pos = getScreenPosition(light);
				effectRadialBlur.uniforms[ 'center' ].value.x = (pos.x+0.5)*0.6 + 0.2;
				effectRadialBlur.uniforms[ 'center' ].value.y = (pos.y+0.5)*0.6 + 0.2;


				if (has_gl) {
					renderer.render( sceneDepth, camera, depthTarget, true );

					composer.render( 0.01 );
				}

			}

		</script>
	

</font><div style="cursor: url(&quot;cursor.png&quot;), pointer;"><canvas width="1920" height="891"></canvas></div><div id="HUABAN_WIDGETS"><div class="HUABAN-f-button" style="display: none;">采集</div><style>#HUABAN_WIDGETS  {font-family: "helvetica neue",arial,sans-serif; color: #444; font-size: 14px;} #HUABAN_WIDGETS * {box-sizing: content-box;} #HUABAN_WIDGETS .HUABAN-main {position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: #e5e5e5; background: rgba(229,229,229,.95); max-height: 100%; overflow: hidden; z-index: 9999999999999;} #HUABAN_WIDGETS a img {border: 0;} #HUABAN_WIDGETS .HUABAN-header {height: 50px; background: white; box-shadow: 0 0 4px rgba(0,0,0,.2); width: 100%; left: 0; top: 0; position: absolute;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-inner {margin: 0 auto; position: relative;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close {width: 60px; height: 50px; border-left: 1px solid #ddd; position: absolute; right: 0; top: 0; background: url(//huaban.com/img/widgets/btn_close.png) 20px 14px no-repeat; cursor: pointer;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close:hover {background-position: 20px -26px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close:active {background-position: 20px -66px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-logo {display: block; position: absolute; top: 12px;} #HUABAN_WIDGETS .HUABAN-waterfall-holder {position: relative; overflow-y: auto; height: 100%;} #HUABAN_WIDGETS .HUABAN-waterfall {position: relative; margin-top: 50px;} #HUABAN_WIDGETS .HUABAN-waterfall .HUABAN-empty {position: absolute; left: 50%; top: 30px; height: 36px; line-height: 36px; width: 216px; text-align: left; margin-left: -128px; color: #777; background: url(//huaban.com/img/widgets/icon_notice.png) 12px 8px no-repeat white; padding-left: 40px; font-size: 15px;} #HUABAN_WIDGETS .HUABAN-btn {display: inline-block; border-radius: 2px; font-size: 14px; padding: 0 12px; height: 30px; line-height: 30px; cursor: pointer; text-decoration: none; white-space: nowrap; -moz-user-select: none; -webkit-user-select: none; user-select: none; text-align: center; background: #D53939; color: white;} #HUABAN_WIDGETS .HUABAN-btn:hover {background: #E54646;} #HUABAN_WIDGETS .HUABAN-btn:active {background: #C52424;} #HUABAN_WIDGETS .HUABAN-wbtn {background: #EDEDED; color: #444;} #HUABAN_WIDGETS .HUABAN-wbtn:hover {background: #F2F2F2;} #HUABAN_WIDGETS .HUABAN-wbtn:active {background: #DDD;} #HUABAN_WIDGETS .HUABAN-f-button {position: absolute; display: none; z-index: 9999999999998; box-shadow: 0 0 0 2px rgba(255,255,255,.2); background: #aaa; background: rgba(0,0,0,.3); color: white; cursor: pointer; padding: 0 12px; height: 30px; line-height: 30px; border-radius: 2px; font-size: 14px} #HUABAN_WIDGETS .HUABAN-f-button:hover {background-color: #999; background-color: rgba(0,0,0,.5);} #HUABAN_WIDGETS .HUABAN-f-button:active {background-color: rgba(0,0,0,.6);} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button {width: 36px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -200px no-repeat; box-shadow: none !important; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button:hover {background-position: -130px -200px;} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button:active {background-position: -260px -200px;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button {width: 80px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -150px no-repeat; box-shadow: none !important; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button:hover {background-position: -130px -150px;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button:active {background-position: -260px -150px;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button {width: 30px; height: 21px; border: 0px; line-height: 21px; padding-left: 20px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -250px no-repeat; box-shadow: none !important; font-size: 12px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button:hover {background-position: -130px -250px;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button:active {background-position: -260px -250px;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button {width: 36px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -500px no-repeat; box-shadow: none !important; color: #444; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button:hover {background-position: -130px -500px;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button:active {background-position: -260px -500px;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button {width: 80px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -450px no-repeat; box-shadow: none !important; color: #444; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button:hover {background-position: -130px -450px;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button:active {background-position: -260px -450px;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button {width: 30px; height: 21px; border: 0px; line-height: 21px; padding-left: 20px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -550px no-repeat; box-shadow: none !important; color: #444; font-size: 12px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button:hover {background-position: -130px -550px;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button:active {background-position: -260px -550px;} #HUABAN_WIDGETS .HUABAN-cell {width: 236px; position: absolute; background: white; box-shadow: 0 1px 3px rgba(0,0,0,.3); transition: left .3s ease-in-out, top .3s linear;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-img-holder {overflow: hidden; position: relative;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-img-holder:hover img.HUABAN-cell-img {opacity: .8} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-video-icon {width: 72px; height: 62px; position: absolute; left: 50%; top: 50%; margin: -31px auto auto -36px; background: url(//huaban.com/img/widgets/media_video.png) 0 0 no-repeat; display: none;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-video .HUABAN-video-icon {display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-over {display: none;} #HUABAN_WIDGETS .HUABAN-cell:hover .HUABAN-over {display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-over .HUABAN-btn {width: 60px; height: 34px; padding: 0; position: absolute; left: 50%; top: 50%; margin: -18px 0 0 -31px; line-height: 34px; box-shadow: 0 0 0 2px rgba(255,255,255,.2); font-size: 16px;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-long .HUABAN-img-holder {height: 600px;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-long .HUABAN-img-holder:after {content: ""; display: block; position: absolute; width: 236px; height: 12px; left: 0; bottom: 0; background: url(//huaban.com/img/widgets/long_image_shadow_2.png) repeat-x 4px top;} #HUABAN_WIDGETS .HUABAN-cell img {width: 236px; display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-size {margin: 8px 16px; font-size: 12px; color: #999} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-description {display: block; width: 202px; margin: 0 6px 6px; padding: 6px 10px; border: 0; resize: none; outline: 0; border: 1px solid transparent; line-height: 18px; font-size: 13px; overflow: hidden; word-wrap: break-word; background: url(//huaban.com/img/widgets/icon_edit.png) 500px center no-repeat;} #HUABAN_WIDGETS .HUABAN-cell:hover .HUABAN-description {background-color: #fff9e0; background-position: right top;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-description:focus {background-color: #F9F9F9; background-position: 500px center;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-select-btn {width: 34px; height:34px; background: url(//huaban.com/img/widgets/checkbox.png) 0 0 no-repeat; position: absolute; right: 5px; top: 5px; cursor: pointer;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-pinned-label {position: absolute; left: 0; top: 10px; height: 24px; line-height: 24px; padding: 0 10px; background: #CE0000; background: rgba(200, 0, 0, 0.9); color: white; font-size: 12px; display: none;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-pinned .HUABAN-pinned-label {display: block;} #HUABAN_WIDGETS .HUABAN-selected .HUABAN-select-btn {background-position: 0 -40px;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-img-holder {cursor: pointer;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-cell-pin-btn {display: none;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-over {display: block;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-buttons {position: absolute; top: 10px; left: 0; display: none;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-buttons .HUABAN-btn {margin-right: 10px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti {display: none; height: 50px; line-height: 50px; text-align: center; font-size: 16px; color: #999; font-weight: bold;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti span {font-weight: normal;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti i {font-style: normal;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-notice {padding: 0 10px; height:30px; line-height: 30px; position: absolute; left: 50%; top: 10px; margin-left: -83px; background: #fff9e2; text-align: center;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-notice i {display: inline-block; width: 18px; height: 18px; background: url(//huaban.com/img/widgets/icon_notice.png) 0 0 no-repeat; vertical-align: top; margin: 6px 6px 0 0;} #HUABAN_WIDGETS .HUABAN-switcher {height: 50px; width: 100px; position: relative;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-title {position: absolute; right: 75px; top: 13px; color: #999; white-space: nowrap; line-height: 24px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-title {visibility: visible; opacity: 1; -webkit-transition: opacity .2s linear; -webkit-transition-delay: .2s; transition: opacity .2s linear; transition-delay: .2s;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar {width: 40px; height: 24px; background: #EB595F; border-radius: 12px; color: white; position: absolute; right: 0; top: 13px; cursor: pointer; font-size: 14px; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar {width: 64px;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on .HUABAN-bar {background: #7DD100;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-round {width: 20px; height: 20px; background: white; border-radius: 50%; position: absolute; left: 2px; top: 2px; -webkit-transition: left .2s linear; box-shadow: 0px 0px 3px rgba(0,0,0,0.15); transition: left .2s linear; box-shadow: 0px 0px 3px rgba(0,0,0,0.15);} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on .HUABAN-bar .HUABAN-round {left: 17px;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-round {left: 41px;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-text-1 {height: 24px; line-height: 24px; position: absolute; right:17px; top: 0; opacity: 0; visibility: hidden; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar .HUABAN-text-1 {right: 9px; opacity: 1; visibility: visible;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-text-1 {right: 17px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-text-2 {height: 24px; line-height: 24px; position: absolute; left:17px; top: 0; opacity: 0; visibility: hidden; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar .HUABAN-text-2 {left: 17px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-text-2 {left: 9px; opacity: 1; visibility: visible;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-switcher {position: absolute; right: 0; top: 0;} <!--[if IE 6]>#HUABAN_WIDGETS .HUABAN-red-normal-icon-button, .HUABAN-red-large-icon-button, .HUABAN-red-small-icon-button, .HUABAN-white-normal-icon-button, .HUABAN-white-large-icon-button, .HUABAN-white-small-icon-button { background-image: url({{imgBase}}/widget_icons_ie6.png) <![endif]--></style></div><div id="shadowMeasureIt"></div><div id="divCoordMeasureIt"></div><div id="divRectangleMeasureIt"><div id="divRectangleBGMeasureIt"></div></div><iframe id="tmp_downloadhelper_iframe" style="display: none;"></iframe></body></html>